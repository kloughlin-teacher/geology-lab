
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>GeologyCraft 3D Lab</title>
<style>
body {
  font-family: Arial, sans-serif;
  background:#dbeaf3;
  text-align:center;
}

canvas {
  border:2px solid black;
  background:#87ceeb;
  cursor:pointer;
}

button {
  margin:4px;
  padding:6px 10px;
}

#directions {
  width: 900px;
  margin: 10px auto;
  background: white;
  padding: 10px;
  border-radius: 6px;
  text-align:left;
  font-size:14px;
}

#labelsList {
  font-size:13px;
  margin-top:5px;
}
</style>
</head>

<body>

<h1>GeologyCraft 3D Lab</h1>

<div id="directions">
<b>Directions:</b><br>
1. Choose a block type.<br>
2. Click grid squares to stack blocks vertically (like Minecraft).<br>
3. Use Collision to simulate mountain building (plates push together).<br>
4. Use Divergent to simulate seafloor spreading (magma rises).<br>
5. Add labels to explain your model.<br>
</div>

<button onclick="setBlock('crust')">Crust</button>
<button onclick="setBlock('mantle')">Mantle</button>
<button onclick="setBlock('magma')">Magma</button>
<button onclick="setBlock('rock')">Rock</button>
<button onclick="setBlock('eraser')">Eraser</button>
<button onclick="addLabel()">Add Text Label</button>
<button onclick="clearAll()">Clear All</button>

<br>

<button onclick="simulateCollision()">Collision (Mountain Building)</button>
<button onclick="simulateDivergent()">Divergent (Seafloor Spreading)</button>

<br><br>

<canvas id="grid" width="900" height="600"></canvas>

<div id="labelsList"></div>

<script>

const canvas = document.getElementById("grid");
const ctx = canvas.getContext("2d");

const cols = 12;
const rows = 8;
const size = 40;
const heightOffset = 20;

let grid = [];
let labels = [];
let currentBlock = "crust";

const colors = {
  crust:"#8B4513",
  mantle:"#CD853F",
  magma:"#FF4500",
  rock:"#808080"
};

function initGrid(){
  for(let r=0;r<rows;r++){
    grid[r]=[];
    for(let c=0;c<cols;c++){
      grid[r][c]=[];
    }
  }
}

function isoX(c,r){
  return (c-r)*size/2 + 450;
}

function isoY(c,r){
  return (c+r)*size/4 + 150;
}

function drawCube(c,r,h,color){
  const x = isoX(c,r);
  const y = isoY(c,r) - h*heightOffset;

  ctx.fillStyle = color;

  ctx.beginPath();
  ctx.moveTo(x, y);
  ctx.lineTo(x+size/2, y+size/4);
  ctx.lineTo(x, y+size/2);
  ctx.lineTo(x-size/2, y+size/4);
  ctx.closePath();
  ctx.fill();
  ctx.stroke();
}

function drawGrid(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  for(let r=0;r<rows;r++){
    for(let c=0;c<cols;c++){
      for(let h=0;h<grid[r][c].length;h++){
        drawCube(c,r,h,grid[r][c][h]);
      }
    }
  }

  drawLabels();
}

function setBlock(type){
  currentBlock = type;
}

canvas.addEventListener("click", function(e){
  const rect = canvas.getBoundingClientRect();
  const mx = e.clientX - rect.left;
  const my = e.clientY - rect.top;

  for(let r=0;r<rows;r++){
    for(let c=0;c<cols;c++){
      const x = isoX(c,r);
      const y = isoY(c,r);

      if(Math.abs(mx-x)<20 && Math.abs(my-y)<20){
        if(currentBlock==="eraser"){
          grid[r][c].pop();
        } else {
          grid[r][c].push(colors[currentBlock]);
        }
      }
    }
  }

  drawGrid();
});

function simulateCollision(){
  // Plates push inward from left and right, building mountains
  for(let r=0;r<rows;r++){
    for(let c=1;c<cols-1;c++){
      if(grid[r][c].length > 0){
        grid[r][c].push("#654321");
      }
    }
  }
  drawGrid();
}

function simulateDivergent(){
  // Magma rises from center row
  let mid = Math.floor(cols/2);
  for(let r=0;r<rows;r++){
    grid[r][mid].push(colors["magma"]);
  }
  drawGrid();
}

function clearAll(){
  initGrid();
  labels = [];
  drawGrid();
  updateLabelList();
}

function addLabel(){
  const text = prompt("Enter label text:");
  if(!text) return;

  labels.push({text:text, x:450, y:100});
  updateLabelList();
  drawGrid();
}

function drawLabels(){
  ctx.fillStyle="black";
  ctx.font="14px Arial";
  labels.forEach(l=>{
    ctx.fillText(l.text, l.x, l.y);
  });
}

function updateLabelList(){
  document.getElementById("labelsList").innerHTML =
    "<b>Labels:</b><br>" +
    labels.map(l=>l.text).join("<br>");
}

initGrid();
drawGrid();

</script>

</body>
</html>
